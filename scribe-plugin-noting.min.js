!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.scribePluginNoting=e()}}(function(){return function e(t,n,r){function o(a,u){if(!n[a]){if(!t[a]){var s="function"==typeof require&&require;if(!u&&s)return s(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[a]={exports:{}};t[a][0].call(f.exports,function(e){var n=t[a][1][e];return o(n?n:e)},f,f.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(){},{}],2:[function(e,t){(function(e){function n(e,t){return r[e]?r[e]:(Object.defineProperty(r,e,{value:t,configurable:!0}),t)}var r="undefined"!=typeof window?window:"undefined"!=typeof e?e:{};t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(e,t){function n(e,t){return t=t||null,1==e.nodeType?o(e,t):3==e.nodeType?r(e,t):void 0}function r(e){return new u(e.nodeValue)}function o(e){for(var t=e.tagName,r="http://www.w3.org/1999/xhtml"==e.namespaceURI?null:e.namespaceURI,o=i(e),u=[],s=0;s<e.childNodes.length;s++)u.push(n(e.childNodes[s]));return new a(t,o,u,null,r)}function i(e){var t={};return s.forEach(function(n){if(e[n]){if("style"==n){for(var r,o={},i=0;i<e.style;i++)r=e.style[i],o[r]=e.style.getPropertyValue(r);return void(t[n]=o)}if("dataset"==n){var a={};for(var u in e.dataset)a[u]=e.dataset[u];return void(t[n]=a)}"attributes"!=n&&(t[n]=e[n])}}),t}var a=e("vtree/vnode"),u=e("vtree/vtext");t.exports=n,n.fromHTML=function(e,t){var r=document.createElement("div");return r.innerHTML=e,r=r.children[0]||r,n(r,t)};{var s=t.exports.properties=["accept","accessKey","action","alt","async","autoComplete","autoPlay","cellPadding","cellSpacing","checked","className","colSpan","content","contentEditable","controls","crossOrigin","data","dataset","defer","dir","download","draggable","encType","formNoValidate","href","hrefLang","htmlFor","httpEquiv","icon","id","label","lang","list","loop","max","mediaGroup","method","min","multiple","muted","name","noValidate","pattern","placeholder","poster","preload","radioGroup","readOnly","rel","required","rowSpan","sandbox","scope","scrollLeft","scrolling","scrollTop","selected","span","spellCheck","src","srcDoc","srcSet","start","step","style","tabIndex","target","title","type","value","autoCapitalize","autoCorrect","property","attributes"];t.exports.attrs=["allowFullScreen","allowTransparency","charSet","cols","contextMenu","dateTime","disabled","form","frameBorder","height","hidden","maxLength","role","rows","seamless","size","width","wmode","cx","cy","d","dx","dy","fill","fx","fy","gradientTransform","gradientUnits","offset","points","r","rx","ry","spreadMethod","stopColor","stopOpacity","stroke","strokeLinecap","strokeWidth","textAnchor","transform","version","viewBox","x1","x2","x","y1","y2","y"]}},{"vtree/vnode":8,"vtree/vtext":9}],4:[function(e,t){function n(e){return e&&"function"==typeof e.hook&&!e.hasOwnProperty("hook")}t.exports=n},{}],5:[function(e,t){function n(e){return e&&"VirtualNode"===e.type&&e.version===r}var r=e("./version");t.exports=n},{"./version":7}],6:[function(e,t){function n(e){return e&&"Widget"===e.type}t.exports=n},{}],7:[function(e,t){t.exports="1"},{}],8:[function(e,t){function n(e,t,n,r,c){this.tagName=e,this.properties=t||u,this.children=n||s,this.key=null!=r?String(r):void 0,this.namespace="string"==typeof c?c:null;var f,l=n&&n.length||0,d=0,v=!1,p=!1;for(var h in t)if(t.hasOwnProperty(h)){var m=t[h];a(m)&&(f||(f={}),f[h]=m)}for(var g=0;l>g;g++){var y=n[g];o(y)?(d+=y.count||0,!v&&y.hasWidgets&&(v=!0),p||!y.hooks&&!y.descendantHooks||(p=!0)):!v&&i(y)&&"function"==typeof y.destroy&&(v=!0)}this.count=l+d,this.hasWidgets=v,this.hooks=f,this.descendantHooks=p}var r=e("./version"),o=e("./is-vnode"),i=e("./is-widget"),a=e("./is-vhook");t.exports=n;var u={},s=[];n.prototype.version=r,n.prototype.type="VirtualNode"},{"./is-vhook":4,"./is-vnode":5,"./is-widget":6,"./version":7}],9:[function(e,t){function n(e){this.text=String(e)}var r=e("./version");t.exports=n,n.prototype.version=r,n.prototype.type="VirtualText"},{"./version":7}],10:[function(e,t){var n=e("vtree/diff");t.exports=n},{"vtree/diff":45}],11:[function(e,t){function n(e){return"object"==typeof e&&null!==e}t.exports=n},{}],12:[function(e,t){function n(e,t,n){for(var i in t){var s=t[i];void 0===s?r(e,t,n,i):u(s)?s.hook(e,i,n?n[i]:void 0):a(s)?o(e,t,n,i,s):void 0!==s&&(e[i]=s)}}function r(e,t,n,r){if(n){var o=n[r];if(!u(o))if("attributes"===r)for(var i in o)e.removeAttribute(i);else if("style"===r)for(var a in o)e.style[a]="";else e[r]="string"==typeof o?"":null}}function o(e,t,n,r,o){var u=n?n[r]:void 0;if("attributes"!==r){if(u&&a(u)&&i(u)!==i(o))return void(e[r]=o);a(e[r])||(e[r]={});var s="style"===r?"":void 0;for(var c in o){var f=o[c];e[r][c]=void 0===f?s:f}}else for(var l in o){var d=o[l];void 0===d?e.removeAttribute(l):e.setAttribute(l,d)}}function i(e){return Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__?e.__proto__:e.constructor?e.constructor.prototype:void 0}var a=e("is-object"),u=e("vtree/is-vhook");t.exports=n},{"is-object":11,"vtree/is-vhook":48}],13:[function(e,t){function n(e,t){var c=t?t.document||r:r,f=t?t.warn:null;if(e=s(e).a,u(e))return e.init();if(a(e))return c.createTextNode(e.text);if(!i(e))return f&&f("Item is not a valid virtual dom node",e),null;var l=null===e.namespace?c.createElement(e.tagName):c.createElementNS(e.namespace,e.tagName),d=e.properties;o(l,d);for(var v=e.children,p=0;p<v.length;p++){var h=n(v[p],t);h&&l.appendChild(h)}return l}var r=e("global/document"),o=e("./apply-properties"),i=e("vtree/is-vnode"),a=e("vtree/is-vtext"),u=e("vtree/is-widget"),s=e("vtree/handle-thunk");t.exports=n},{"./apply-properties":12,"global/document":15,"vtree/handle-thunk":46,"vtree/is-vnode":49,"vtree/is-vtext":50,"vtree/is-widget":51}],14:[function(e,t){function n(e,t,n,o){return n&&0!==n.length?(n.sort(i),r(e,t,n,o,0)):{}}function r(e,t,n,i,u){if(i=i||{},e){o(n,u,u)&&(i[u]=e);var s=t.children;if(s)for(var c=e.childNodes,f=0;f<t.children.length;f++){u+=1;var l=s[f]||a,d=u+(l.count||0);o(n,u,d)&&r(c[f],l,n,i,u),u=d}}return i}function o(e,t,n){if(0===e.length)return!1;for(var r,o,i=0,a=e.length-1;a>=i;){if(r=(a+i)/2>>0,o=e[r],i===a)return o>=t&&n>=o;if(t>o)i=r+1;else{if(!(o>n))return!0;a=r-1}}return!1}function i(e,t){return e>t?1:-1}var a={};t.exports=n},{}],15:[function(e,t){(function(n){var r="undefined"!=typeof n?n:"undefined"!=typeof window?window:{},o=e("min-document");if("undefined"!=typeof document)t.exports=document;else{var i=r["__GLOBAL_DOCUMENT_CACHE@4"];i||(i=r["__GLOBAL_DOCUMENT_CACHE@4"]=o),t.exports=i}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"min-document":1}],16:[function(e,t){function n(e,t,n){var s=e.type,d=e.vNode,p=e.patch;switch(s){case v.REMOVE:return r(t,d);case v.INSERT:return o(t,p,n);case v.VTEXT:return i(t,d,p,n);case v.WIDGET:return a(t,d,p,n);case v.VNODE:return u(t,d,p,n);case v.ORDER:return c(t,p),t;case v.PROPS:return l(t,p,d.properties),t;case v.THUNK:return f(t,n.patch(t,p,n));default:return t}}function r(e,t){var n=e.parentNode;return n&&n.removeChild(e),s(e,t),null}function o(e,t,n){var r=p(t,n);return e&&e.appendChild(r),e}function i(e,t,n,r){var o;if(3===e.nodeType)e.replaceData(0,e.length,n.text),o=e;else{var i=e.parentNode;o=p(n,r),i&&i.replaceChild(o,e)}return s(e,t),o}function a(e,t,n,r){if(h(t,n))return n.update(t,e)||e;var o=e.parentNode,i=p(n,r);return o&&o.replaceChild(i,e),s(e,t),i}function u(e,t,n,r){var o=e.parentNode,i=p(n,r);return o&&o.replaceChild(i,e),s(e,t),i}function s(e,t){"function"==typeof t.destroy&&d(t)&&t.destroy(e)}function c(e,t){var n,r=[],o=e.childNodes,i=o.length,a=t.reverse;for(n=0;i>n;n++)r.push(e.childNodes[n]);var u,s,c,f=0;for(n=0;i>n;n++)u=t[n],void 0!==u&&u!==n&&(a[n]>n&&f++,s=r[u],c=o[n+f]||null,s!==c&&e.insertBefore(s,c),n>u&&f--),n in t.removes&&f++}function f(e,t){return e&&t&&e!==t&&e.parentNode&&(console.log(e),e.parentNode.replaceChild(t,e)),t}var l=e("./apply-properties"),d=e("vtree/is-widget"),v=e("vtree/vpatch"),p=e("./create-element"),h=e("./update-widget");t.exports=n},{"./apply-properties":12,"./create-element":13,"./update-widget":18,"vtree/is-widget":51,"vtree/vpatch":55}],17:[function(e,t){function n(e,t){return r(e,t)}function r(e,t,n){var u=i(t);if(0===u.length)return e;var c=s(e,t.a,u),f=e.ownerDocument;n||(n={patch:r},f!==a&&(n.document=f));for(var l=0;l<u.length;l++){var d=u[l];e=o(e,c[d],t[d],n)}return e}function o(e,t,n,r){if(!t)return e;var o;if(u(n))for(var i=0;i<n.length;i++)o=c(n[i],t,r),t===e&&(e=o);else o=c(n,t,r),t===e&&(e=o);return e}function i(e){var t=[];for(var n in e)"a"!==n&&t.push(Number(n));return t}var a=e("global/document"),u=e("x-is-array"),s=e("./dom-index"),c=e("./patch-op");t.exports=n},{"./dom-index":14,"./patch-op":16,"global/document":15,"x-is-array":19}],18:[function(e,t){function n(e,t){return r(e)&&r(t)?"name"in e&&"name"in t?e.id===t.id:e.init===t.init:!1}var r=e("vtree/is-widget");t.exports=n},{"vtree/is-widget":51}],19:[function(e,t){function n(e){return"[object Array]"===o.call(e)}var r=Array.isArray,o=Object.prototype.toString;t.exports=r||n},{}],20:[function(e,t){var n=e("vdom/patch");t.exports=n},{"vdom/patch":17}],21:[function(e,t){function n(e){return this instanceof n?void(this.value=e):new n(e)}var r=e("data-set");t.exports=n,n.prototype.hook=function(e,t){var n=r(e),o=t.substr(5);n[o]=this.value}},{"data-set":26}],22:[function(e,t){function n(e){return this instanceof n?void(this.value=e):new n(e)}var r=e("data-set");t.exports=n,n.prototype.hook=function(e,t){var n=r(e),o=t.substr(3);n[o]=this.value}},{"data-set":26}],23:[function(e,t){function n(e){return this instanceof n?void(this.value=e):new n(e)}t.exports=n,n.prototype.hook=function(e,t){e[t]!==this.value&&(e[t]=this.value)}},{}],24:[function(e,t){function n(e,t,n){var o,u,s,c,f=[];!n&&i(t)&&(n=t,u={}),u=u||t||{},o=p(e,u),"key"in u&&(s=u.key,u.key=void 0),"namespace"in u&&(c=u.namespace,u.namespace=void 0),"input"===o&&"value"in u&&void 0!==u.value&&!l(u.value)&&(u.value=h(u.value));for(var d,v,y=Object.keys(u),N=0;N<y.length;N++)d=y[N],v=u[d],l(v)||("data-"===d.substr(0,5)&&(u[d]=m(v)),"ev-"===d.substr(0,3)&&(u[d]=g(v)));void 0!==n&&null!==n&&r(n,f,o,u);var x=new a(o,u,f,s,c);return x}function r(e,t,n,i){if("string"==typeof e)t.push(new u(e));else if(o(e))t.push(e);else{if(!Array.isArray(e)){if(null===e||void 0===e)return;throw y({foreignObjectStr:JSON.stringify(e),foreignObject:e,parentVnodeStr:JSON.stringify({tagName:n,properties:i}),parentVnode:{tagName:n,properties:i}})}for(var a=0;a<e.length;a++)r(e[a],t,n,i)}}function o(e){return s(e)||c(e)||f(e)||d(e)}function i(e){return"string"==typeof e||Array.isArray(e)||o(e)}var a=e("vtree/vnode.js"),u=e("vtree/vtext.js"),s=e("vtree/is-vnode"),c=e("vtree/is-vtext"),f=e("vtree/is-widget"),l=e("vtree/is-vhook"),d=e("vtree/is-thunk"),v=e("error/typed"),p=e("./parse-tag.js"),h=e("./hooks/soft-set-hook.js"),m=e("./hooks/data-set-hook.js"),g=e("./hooks/ev-hook.js"),y=v({type:"virtual-hyperscript.unexpected.virtual-element",message:"Unexpected virtual child passed to h().\nExpected a VNode / Vthunk / VWidget / string but:\ngot a {foreignObjectStr}.\nThe parent vnode is {parentVnodeStr}.\nSuggested fix: change your `h(..., [ ... ])` callsite.",foreignObjectStr:null,parentVnodeStr:null,foreignObject:null,parentVnode:null});t.exports=n},{"./hooks/data-set-hook.js":21,"./hooks/ev-hook.js":22,"./hooks/soft-set-hook.js":23,"./parse-tag.js":44,"error/typed":35,"vtree/is-thunk":36,"vtree/is-vhook":37,"vtree/is-vnode":38,"vtree/is-vtext":39,"vtree/is-widget":40,"vtree/vnode.js":42,"vtree/vtext.js":43}],25:[function(e,t){function n(e){var t=e.attributes,n={};if(null===t||void 0===t)return n;for(var r=0;r<t.length;r++){var o=t[r];"data-"===o.name.substr(0,5)&&(n[o.name.substr(5)]=o.value)}return n}t.exports=n},{}],26:[function(e,t){function n(e){var t=a(e);return t.hash||(t.hash=i(e)),t.hash}var r=e("weakmap-shim/create-store"),o=e("individual"),i=e("./create-hash.js"),a=o("__DATA_SET_WEAKMAP@3",r());t.exports=n},{"./create-hash.js":25,individual:2,"weakmap-shim/create-store":57}],27:[function(e,t){function n(e){return e&&"object"==typeof e?a(e)?o(e,n):i(s(e),function(t,o){var i=r(o);return t[i]=n(e[o]),t},{}):e}function r(e){return e.replace(/[_.-](\w|$)/g,function(e,t){return t.toUpperCase()})}function o(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}function i(e,t,n){if(e.reduce)return e.reduce(t,n);for(var r=0;r<e.length;r++)n=t(n,e[r],r);return n}t.exports=function(e){return"string"==typeof e?r(e):n(e)};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},u=Object.prototype.hasOwnProperty,s=Object.keys||function(e){var t=[];for(var n in e)u.call(e,n)&&t.push(n);return t}},{}],28:[function(e,t){function n(e){var t;return t=2===arguments.length&&"object"==typeof arguments[1]?arguments[1]:o.call(arguments,1),t&&t.hasOwnProperty||(t={}),e.replace(r,function(n,r,o){var i;return"{"===e[o-1]&&"}"===e[o+n.length]?r:(i=t.hasOwnProperty(r)?t[r]:null,null===i||void 0===i?"":i)})}var r=/\{([0-9a-zA-Z]+)\}/g,o=Array.prototype.slice;t.exports=n},{}],29:[function(e,t){function n(e){return null!==e&&("object"==typeof e||"function"==typeof e)}t.exports=n},{}],30:[function(e,t){function n(e){for(var t=[].slice.call(arguments,1),n=0;n<t.length;n++){var i=t[n];if(o(i))for(var a=r(i),u=0;u<a.length;u++){var s=a[u];e[s]=i[s]}}return e}var r=e("object-keys"),o=e("./has-keys");t.exports=n},{"./has-keys":29,"object-keys":32}],31:[function(e,t){var n=Object.prototype.hasOwnProperty,r=Object.prototype.toString,o=function(e){var t="function"==typeof e&&!(e instanceof RegExp)||"[object Function]"===r.call(e);return t||"undefined"==typeof window||(t=e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt),t};t.exports=function(e,t){if(!o(t))throw new TypeError("iterator must be a function");var r,i,a="string"==typeof e,u=e.length,s=arguments.length>2?arguments[2]:null;if(u===+u)for(r=0;u>r;r++)null===s?t(a?e.charAt(r):e[r],r,e):t.call(s,a?e.charAt(r):e[r],r,e);else for(i in e)n.call(e,i)&&(null===s?t(e[i],i,e):t.call(s,e[i],i,e))}},{}],32:[function(e,t){t.exports=Object.keys||e("./shim")},{"./shim":34}],33:[function(e,t){var n=Object.prototype.toString;t.exports=function r(e){var t=n.call(e),r="[object Arguments]"===t;return r||(r="[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===n.call(e.callee)),r}},{}],34:[function(e,t){!function(){"use strict";var n,r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,i=e("./foreach"),a=e("./isArguments"),u=!{toString:null}.propertyIsEnumerable("toString"),s=function(){}.propertyIsEnumerable("prototype"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];n=function(e){var t=null!==e&&"object"==typeof e,n="[object Function]"===o.call(e),f=a(e),l=[];if(!t&&!n&&!f)throw new TypeError("Object.keys called on a non-object");if(f)i(e,function(e){l.push(e)});else{var d,v=s&&n;for(d in e)v&&"prototype"===d||!r.call(e,d)||l.push(d)}if(u){var p=e.constructor,h=p&&p.prototype===e;i(c,function(t){h&&"constructor"===t||!r.call(e,t)||l.push(t)})}return l},t.exports=n}()},{"./foreach":31,"./isArguments":33}],35:[function(e,t){function n(e){function t(t){var r=new Error;Object.defineProperty(r,"type",{value:r.type,enumerable:!0,writable:!0,configurable:!0});var a=i({},e,t);return i(r,a),r.message=o(n,a),r}if(!e)throw new Error("args is required");if(!e.type)throw new Error("args.type is required");if(!e.message)throw new Error("args.message is required");var n=e.message;if(e.type&&!e.name){var a=r(e.type)+"Error";e.name=a[0].toUpperCase()+a.substr(1)}return t.type=e.type,t._name=e.name,t}var r=e("camelize"),o=e("string-template"),i=e("xtend/mutable");t.exports=n},{camelize:27,"string-template":28,"xtend/mutable":30}],36:[function(e,t){function n(e){return e&&"Thunk"===e.type}t.exports=n},{}],37:[function(e,t){t.exports=e(4)},{"/home/vagrant/Development/scribe-plugin-noting/node_modules/vdom-virtualize/node_modules/vtree/is-vhook.js":4}],38:[function(e,t){t.exports=e(5)},{"./version":41,"/home/vagrant/Development/scribe-plugin-noting/node_modules/vdom-virtualize/node_modules/vtree/is-vnode.js":5}],39:[function(e,t){function n(e){return e&&"VirtualText"===e.type&&e.version===r}var r=e("./version");t.exports=n},{"./version":41}],40:[function(e,t){t.exports=e(6)},{"/home/vagrant/Development/scribe-plugin-noting/node_modules/vdom-virtualize/node_modules/vtree/is-widget.js":6}],41:[function(e,t){t.exports=e(7)},{"/home/vagrant/Development/scribe-plugin-noting/node_modules/vdom-virtualize/node_modules/vtree/version.js":7}],42:[function(e,t){t.exports=e(8)},{"./is-vhook":37,"./is-vnode":38,"./is-widget":40,"./version":41,"/home/vagrant/Development/scribe-plugin-noting/node_modules/vdom-virtualize/node_modules/vtree/vnode.js":8}],43:[function(e,t){t.exports=e(9)},{"./version":41,"/home/vagrant/Development/scribe-plugin-noting/node_modules/vdom-virtualize/node_modules/vtree/vtext.js":9}],44:[function(e,t){function n(e,t){if(!e)return"div";var n=!("id"in t),i=e.split(r),a=null;o.test(i[1])&&(a="div");var u,s,c,f;for(f=0;f<i.length;f++)s=i[f],s&&(c=s.charAt(0),a?"."===c?(u=u||[],u.push(s.substring(1,s.length))):"#"===c&&n&&(t.id=s.substring(1,s.length)):a=s);return u&&(t.className&&u.push(t.className),t.className=u.join(" ")),a?a.toLowerCase():"div"}var r=/([\.#]?[a-zA-Z0-9_:-]+)/,o=/^\.|#/;t.exports=n},{}],45:[function(e,t){function n(e,t){var n={a:e};return r(e,t,n,0),n}function r(e,t,n,r){if(e===t)return void(x(e)||x(t)?s(e,t,n,r):f(t,n,r));var i=n[r];if(null==t)i=v(i,new m(m.REMOVE,e,t)),u(e,n,r);else if(x(e)||x(t))s(e,t,n,r);else if(g(t))if(g(e)){if(e.tagName===t.tagName&&e.namespace===t.namespace&&e.key===t.key){var c=o(e.properties,t.properties,t.hooks);c&&(i=v(i,new m(m.PROPS,e,c)))}else i=v(i,new m(m.VNODE,e,t)),u(e,n,r);i=a(e,t,n,i,r)}else i=v(i,new m(m.VNODE,e,t)),u(e,n,r);else y(t)?y(e)?e.text!==t.text&&(i=v(i,new m(m.VTEXT,e,t))):(i=v(i,new m(m.VTEXT,e,t)),u(e,n,r)):N(t)&&(i=v(i,new m(m.WIDGET,e,t)),N(e)||u(e,n,r));i&&(n[r]=i)}function o(e,t,n){var r;for(var a in e){a in t||(r=r||{},r[a]=void 0);var u=e[a],s=t[a];if(n&&a in n)r=r||{},r[a]=s;else if(h(u)&&h(s))if(i(s)!==i(u))r=r||{},r[a]=s;else{var c=o(u,s);c&&(r=r||{},r[a]=c)}else u!==s&&(r=r||{},r[a]=s)}for(var f in t)f in e||(r=r||{},r[f]=t[f]);return r}function i(e){return Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__?e.__proto__:e.constructor?e.constructor.prototype:void 0}function a(e,t,n,o,i){for(var a=e.children,s=l(a,t.children),c=a.length,f=s.length,d=c>f?c:f,p=0;d>p;p++){var h=a[p],y=s[p];i+=1,h?y?r(h,y,n,i):h&&(n[i]=new m(m.REMOVE,h,null),u(h,n,i)):y&&(o=v(o,new m(m.INSERT,null,y))),g(h)&&h.count&&(i+=h.count)}return s.moves&&(o=v(o,new m(m.ORDER,e,s.moves))),o}function u(e,t,n){if(N(e))"function"==typeof e.destroy&&(t[n]=new m(m.REMOVE,e,null));else if(g(e)&&e.hasWidgets)for(var r=e.children,o=r.length,i=0;o>i;i++){var a=r[i];n+=1,u(a,t,n),g(a)&&a.count&&(n+=a.count)}}function s(e,t,r,o){var i=w(e,t),a=n(i.a,i.b);c(a)&&(r[o]=new m(m.THUNK,null,a))}function c(e){for(var t in e)if("a"!==t)return!0;return!1}function f(e,t,n){if(g(e)&&(e.hooks&&(t[n]=new m(m.PROPS,e.hooks,e.hooks)),e.descendantHooks))for(var r=e.children,o=r.length,i=0;o>i;i++){var a=r[i];n+=1,f(a,t,n),g(a)&&a.count&&(n+=a.count)}}function l(e,t){var n=d(t);if(!n)return t;var r=d(e);if(!r)return t;var o={},i={};for(var a in n)o[n[a]]=r[a];for(var a in r)i[r[a]]=n[a];for(var u=e.length,s=t.length,c=u>s?u:s,f=[],l=0,v=0,p=0,h={},m=h.removes={},g=h.reverse={},y=!1;c>l;){var N=i[v];if(void 0!==N)f[v]=t[N],N!==p&&(h[N]=p,g[p]=N,y=!0),p++;else if(v in i)f[v]=void 0,m[v]=p++,y=!0;else{for(;void 0!==o[l];)l++;if(c>l){var x=t[l];x&&(f[v]=x,l!==p&&(y=!0,h[l]=p,g[p]=l),p++),l++}}v++}return y&&(f.moves=h),f}function d(e){var t,n;for(t=0;t<e.length;t++){var r=e[t];void 0!==r.key&&(n=n||{},n[r.key]=t)}return n}function v(e,t){return e?(p(e)?e.push(t):e=[e,t],e):t}var p=e("x-is-array"),h=e("is-object"),m=e("./vpatch"),g=e("./is-vnode"),y=e("./is-vtext"),N=e("./is-widget"),x=e("./is-thunk"),w=e("./handle-thunk");t.exports=n},{"./handle-thunk":46,"./is-thunk":47,"./is-vnode":49,"./is-vtext":50,"./is-widget":51,"./vpatch":55,"is-object":52,"x-is-array":53}],46:[function(e,t){function n(e,t){var n=e,o=t;return u(t)&&(o=r(t,e)),u(e)&&(n=r(e,null)),{a:n,b:o}}function r(e,t){var n=e.vnode;if(n||(n=e.vnode=e.render(t)),!(o(n)||i(n)||a(n)))throw new Error("thunk did not return a valid node");return n}var o=e("./is-vnode"),i=e("./is-vtext"),a=e("./is-widget"),u=e("./is-thunk");t.exports=n},{"./is-thunk":47,"./is-vnode":49,"./is-vtext":50,"./is-widget":51}],47:[function(e,t){t.exports=e(36)},{"/home/vagrant/Development/scribe-plugin-noting/node_modules/virtual-hyperscript/node_modules/vtree/is-thunk.js":36}],48:[function(e,t){t.exports=e(4)},{"/home/vagrant/Development/scribe-plugin-noting/node_modules/vdom-virtualize/node_modules/vtree/is-vhook.js":4}],49:[function(e,t){t.exports=e(5)},{"./version":54,"/home/vagrant/Development/scribe-plugin-noting/node_modules/vdom-virtualize/node_modules/vtree/is-vnode.js":5}],50:[function(e,t){t.exports=e(39)},{"./version":54,"/home/vagrant/Development/scribe-plugin-noting/node_modules/virtual-hyperscript/node_modules/vtree/is-vtext.js":39}],51:[function(e,t){t.exports=e(6)},{"/home/vagrant/Development/scribe-plugin-noting/node_modules/vdom-virtualize/node_modules/vtree/is-widget.js":6}],52:[function(e,t){t.exports=e(11)},{"/home/vagrant/Development/scribe-plugin-noting/node_modules/virtual-dom/node_modules/is-object/index.js":11}],53:[function(e,t){t.exports=e(19)},{"/home/vagrant/Development/scribe-plugin-noting/node_modules/virtual-dom/node_modules/x-is-array/index.js":19}],54:[function(e,t){t.exports=e(7)},{"/home/vagrant/Development/scribe-plugin-noting/node_modules/vdom-virtualize/node_modules/vtree/version.js":7}],55:[function(e,t){function n(e,t,n){this.type=Number(e),this.vNode=t,this.patch=n}var r=e("./version");n.NONE=0,n.VTEXT=1,n.VNODE=2,n.WIDGET=3,n.PROPS=4,n.ORDER=5,n.INSERT=6,n.REMOVE=7,n.THUNK=8,t.exports=n,n.prototype.version=r,n.prototype.type="VirtualPatch"},{"./version":54}],56:[function(e,t){t.exports=e(9)},{"./version":54,"/home/vagrant/Development/scribe-plugin-noting/node_modules/vdom-virtualize/node_modules/vtree/vtext.js":9}],57:[function(e,t){function n(){var e={};return function(t){if("object"!=typeof t||null===t)throw new Error("Weakmap-shim: Key must be object");var n=t.valueOf(e);return n&&n.identity===e?n:r(t,e)}}var r=e("./hidden-store.js");t.exports=n},{"./hidden-store.js":58}],58:[function(e,t){function n(e,t){var n={identity:t},r=e.valueOf;return Object.defineProperty(e,"valueOf",{value:function(e){return e!==t?r.apply(this,arguments):n},writable:!0}),n}t.exports=n},{}],59:[function(e,t){var n=e("./src/noting-commands");t.exports=function(e){return function(t){n.init(t,e)}}},{"./src/noting-commands":63}],60:[function(e,t,n){function r(e,t,n){var r=e.properties.className.split(" "),o=r.indexOf(t);-1!==o?n!==!0&&r.splice(o,1):n!==!1&&r.push(t),e.properties.className=r.join(" ")}function o(e,t){Array.isArray(e)?e.forEach(function(e){r(e.vNode,a,t)}):r(e.vNode,a,t)}var i=e("./note-vdom"),a="note--collapsed";n.collapseToggleSelectedNote=function(e){var t=i.findSelectedNote(e);o(t)},n.collapseToggleAllNotes=function(e,t){i.findAllNotes(e).forEach(function(e){o(e,t)})}},{"./note-vdom":62}],61:[function(e,t,n){"use strict";function r(e,t){var n=e instanceof Array?e:[e],t=t?b.clone(t):{},r=N(E+"."+O,{title:u(t),dataset:t},n);return r}function o(e){var t=e.vNode,n=t.children,r=e.parent.vNode.children.indexOf(t);e.parent.vNode.children.splice(r,1,n),e.parent.vNode.children=b.flatten(e.parent.vNode.children),e.vNode=e.parent.vNode,e.parent=e.parent.parent}function i(e){a(e),e.forEach(s);var t=e[0].top();d(t)}function a(e){function t(e,t){var n=e.properties.className.split(" ");n.push(t),e.properties.className=b.uniq(n).join(" ")}function n(e,t){var n=e.properties.className.split(" "),r=n.indexOf(t);-1!=r&&(n.splice(r,1),e.properties.className=n.join(" "))}function r(e){t(e[0].vNode,"note--start"),t(e[e.length-1].vNode,"note--end")}function o(e){e.forEach(function(e){n(e.vNode,"note--start"),n(e.vNode,"note--end")})}o(e),r(e)}function u(e){var t=new Date(e[_]),n=[t.getDate()+"/"+(t.getMonth()+1)+"/"+t.getFullYear(),"at",t.getHours()+":"+(t.getMinutes()<9?"0":"")+t.getMinutes()].join(" ");return e[j]+"  "+n}function s(e){var t=c();e.vNode.properties.dataset[j]=t[j],e.vNode.properties.dataset[_]=t[_],e.vNode.properties.title=u(t)}function c(){var e={};return e[j]=n.user,e[_]=(new Date).toISOString(),e}function f(){return N("em.scribe-marker",[])}function l(e){return N(S+".note-barrier.note-barrier--"+e)}function d(e){function t(e){e.filter(T.focusOnNoteBarrier).forEach(function(e){e.remove()})}function n(e){T.findAllNotes(e).forEach(function(e){b.first(e).next().insertBefore(l("start")),b.last(e).insertAfter(l("end"))})}t(e),n(e)}function v(e){var t="​",n=r([t,f()],c()),o=T.findMarkers(e)[0];o.replace(n);var a=T.findEntireNote(o);i(a)}function p(e){var t=T.findTextNodeFocusesBetweenMarkers(e).filter(T.focusOutsideNote),n=c(),o=t.map(function(e){return r(e.vNode,n)});b.zip(t,o).forEach(function(e){var t=e[0],n=e[1];t.replace(n)}),y(e),T.removeVirtualScribeMarkers(e);var a=T.findFirstNoteSegment(t[0]);a.next().insertBefore(l());var u=T.findLastNoteSegment(t[0]);u.insertAfter([l(),new w("​"),f()]);var s=T.findEntireNote(u);i(s)}function h(e){var t=T.findMarkers(e)[0],n=T.findAncestorNoteSegment(t),r=T.findEntireNote(n);r.forEach(o)}function m(e){function t(e){var t=e.vNode;return-1===f.indexOf(t)}var n=T.findTextNodeFocusesBetweenMarkers(e),a=T.findEntireNote(n[0]),u=T.findEntireNoteTextNodeFocuses(a[0]),s=b(a).map(function(e){return e.vNode.children}).flatten().filter(x).value(),f=n.map(function(e){return e.vNode}),l=b.difference(s,f),d=u.filter(t),v=c(),p=l.map(function(e){return r(e,v)});b.zip(d,p).forEach(function(e){var t=e[0],n=e[1];t.replace(n)}),a.forEach(o);var h=d[0].refresh(),m=T.findEntireNote(h),g=d[d.length-1].refresh(),y=T.findEntireNote(g);i(m),i(y);var w=T.findMarkers(e.refresh());b.last(w).insertAfter(N("span")),w[0].remove()}function g(e){function t(e){function t(e){return e.vNode.properties.dataset[_]}var n=b(e).map(t).uniq().value();return n.length>1}function n(e){var t="noteStart"in e[0].vNode.properties.dataset,n="noteEnd"in e[e.length-1].vNode.properties.dataset;return!(t&&n)}function r(e){return t(e)||n(e)}T.findAllNotes(e).filter(r).forEach(i)}function y(e){function t(e){return!!e}function n(e){for(var t=e;t;)t.canDown()||t.remove(),t=t.up()}function r(e){var t=e.prev().find(T.focusOnNote,"prev");if(t){var n=b.last(t.vNode.children.filter(x));n&&(n.text=n.text+" ")}}var o=T.findMarkers(e);if(2!==o.length){var i=o[0],a=[i.find(T.focusOnNote,"prev"),i.find(T.focusOnNote)].filter(t);a.filter(function(e){return!!e}).map(function(e){if(T.withEmptyTextNode(e)&&r(e),T.withoutText(e)||T.withEmptyTextNode(e)){var t=e.replace(new w("​"));n(t)}})}}var N=e("virtual-hyperscript"),x=e("vtree/is-vtext"),w=e("vtree/vtext"),b=e("lodash"),k="GU-NOTE",E="gu-note",O="note",j="noteEditedBy",_="noteEditedDate",S="gu-note-barrier",T=e("./note-vdom");n.user="unknown",n.ensureNoteIntegrity=function(e){g(e),d(e),y(e)},n.toggleNoteAtSelection=function(e){function t(){var t,n=T.findMarkers(e),r=1===n.length,o=T.selectionEntirelyWithinNote(n);return t=r&&o?"caretWithinNote":o?"selectionWithinNote":r?"caretOutsideNote":"selectionOutsideNote"}var n={caretWithinNote:function(e){h(e)},selectionWithinNote:function(e){m(e)},caretOutsideNote:function(e){v(e)},selectionOutsideNote:function(e){p(e)}};n[t()](e)},n.isSelectionInANote=function(e,t){function n(e,r){return e.parentNode&&e!==t?r(e)?e:n(e.parentNode,r):!1}function r(e){return n(e,function(e){return e.tagName===k})}return r(e.startContainer)&&r(e.endContainer)&&!0}},{"./note-vdom":62,lodash:"lodash","virtual-hyperscript":24,"vtree/is-vtext":50,"vtree/vtext":56}],62:[function(e,t,n){"use strict";function r(e){return v(e.vNode)}function o(e){return!r(e)}function i(e){return"VirtualText"===e.vNode.type}function a(e){return l(e.vNode)}function u(e){return!m(e)}function s(e){var t="​",n=" ",r=" ";return""===e||e===t||e===n||e===r}function c(e){var t=e.vNode;return V(t)&&s(t.text)}function f(e){return d(e.vNode)}function l(e){return e.tagName&&e.tagName.toLowerCase()===C}function d(e){return e.tagName&&e.tagName.toLowerCase()===M}function v(e){return p(e,"scribe-marker")}function p(e,t){return e.properties&&e.properties.className===t}function h(e){return!i(e)||c(e)||f(e)||m(e)}function m(e){return e.find(a,"up")}function g(e){return S(e.find(r).next().takeWhile(o))}function y(e){return e.filter(r)}function N(e){return R.last(e.takeWhile(h,"prev").filter(a))}function x(e){return R.last(e.takeWhile(h).filter(a))}function w(e){function t(t){return!!t.find(function(t){return t.vNode===e.vNode},"up")}return e.takeWhile(t)}function b(e){return 0===w(e).filter(i).length}function k(e){return w(e).filter(i).every(c)}function E(e){return R(w(e)).rest().value().some(a)}function O(e){return N(e).takeWhile(h).filter(a)}function j(e){return N(e).takeWhile(h).filter(i).filter(function(e){return!c(e)})}function _(e){var t=e.top(),n=[];e=t;for(var r;r=e.find(a);){var o=O(r);n.push(o),e=o[o.length-1].next()}return n}function S(e){return e.filter(i)}function T(e){var t=m(y(e)[0]);return t&&O(t)||void 0}function A(e){if(2===e.length){var t=e[0].next().takeWhile(o).filter(function(e){return!E(e)});return t.every(m)}return!!m(e[0])}function D(e){e.filter(r).forEach(function(e){e.remove()})}var V=e("vtree/is-vtext"),C="gu-note",M="gu-note-barrier",R=e("lodash");n.focusAndDescendants=w,n.focusOnMarker=r,n.focusOnNote=a,n.focusOnNoteBarrier=f,n.focusOnTextNode=i,n.withoutText=b,n.withEmptyTextNode=k,n.findLastNoteSegment=x,n.findEntireNoteTextNodeFocuses=j,n.focusOutsideNote=u,n.findSelectedNote=T,n.findAllNotes=_,n.findEntireNote=O,n.findFirstNoteSegment=N,n.findMarkers=y,n.isScribeMarker=v,n.findAncestorNoteSegment=m,n.findTextNodeFocusesBetweenMarkers=g,n.removeVirtualScribeMarkers=D,n.selectionEntirelyWithinNote=A},{lodash:"lodash","vtree/is-vtext":50}],63:[function(e,t,n){"use strict";function r(e){var t=new e.api.Command("insertHTML");return t.execute=function(){l.mutateScribe(e,function(e,t){c.toggleNoteAtSelection(e,t)})},t.queryState=function(){var t=new e.api.Selection;return c.isSelectionInANote(t.range,e.el)},t.queryEnabled=function(){return!0},t}function o(e){var t=new e.api.Command("insertHTML");return t.execute=function(){l.mutateScribe(e,function(e){f.collapseToggleSelectedNote(e)})},t.queryState=function(){},t}function i(e){var t=new e.api.Command("insertHTML");return t.execute=function(){var t=!this._state;l.mutate(e.el,function(e){f.collapseToggleAllNotes(e,t)}),this._state=t},t.queryEnabled=function(){return!!e.el.getElementsByTagName("gu-note").length},t.queryState=function(){return this.queryEnabled()&&!!this._state},t}function a(e){e.el.addEventListener("keydown",function(t){var n=119===t.keyCode,r=121===t.keyCode,o=t.altKey&&8===t.keyCode;(n||r||o)&&(t.preventDefault(),e.getCommand("note").execute())})}function u(e){e.el.addEventListener("click",function(t){var n=t.target;if("GU-NOTE"==n.nodeName){var r=new e.api.Selection,o=document.createRange();o.selectNodeContents(n),r.selection.removeAllRanges(),r.selection.addRange(o),e.getCommand("noteCollapseToggle").execute()
}})}function s(e){e.el.addEventListener("input",function(){l.mutateScribe(e,function(e){c.ensureNoteIntegrity(e)})})}var c=e("./api/note-toggle"),f=e("./api/note-collapse"),l=e("./noting-vdom");n.init=function(e,t){c.user=t,e.commands.note=r(e),e.commands.noteCollapseToggle=o(e),e.commands.noteCollapseToggleAll=i(e),a(e),u(e),s(e)}},{"./api/note-collapse":60,"./api/note-toggle":61,"./noting-vdom":64}],64:[function(e,t,n){var r=(e("lodash"),e("virtual-dom/diff")),o=e("virtual-dom/patch"),i=e("vdom-virtualize"),a=(e("vtree/is-vtext"),e("./vfocus"));n.mutate=function(e,t){var n=i(e),u=i(e),s=new a(u);t(s);var c=r(n,u);o(e,c)},n.mutateScribe=function(e,t){var r=new e.api.Selection;r.placeMarkers(),n.mutate(e.el,function(e){t(e,r)}),r.selectMarkers(),r.removeMarkers()}},{"./vfocus":65,lodash:"lodash","vdom-virtualize":3,"virtual-dom/diff":10,"virtual-dom/patch":20,"vtree/is-vtext":50}],65:[function(e,t){function n(e,t){this.vNode=e,this.parent=t}t.exports=n,n.prototype.rightVNode=function(){if(this.isRoot())return null;var e=this.parent.vNode.children.indexOf(this.vNode)+1;return this.parent.vNode.children[e]},n.prototype.leftVNode=function(){if(this.isRoot())return null;var e=this.parent.vNode.children.indexOf(this.vNode)-1;return e>=0?this.parent.vNode.children[e]:null},n.prototype.isRoot=function(){return!this.parent},n.prototype.canRight=function(){return!!this.rightVNode()},n.prototype.canLeft=function(){return!!this.leftVNode()},n.prototype.canDown=function(){return this.vNode.children&&this.vNode.children.length?!0:!1},n.prototype.canUp=function(){return!this.isRoot()},n.prototype.next=function(){function e(t){return null===t?null:t.right()||e(t.up())}return this.down()||this.right()||e(this.up())},n.prototype.prev=function(){function e(t){function n(e){for(var t=e;t.canRight();)t=t.right();return t}return t.canDown()?e(t.down()):n(t)}var t;return t=this.left()&&this.left().down()?e(this.left()):this.left()?this.left():this.up()},n.prototype.down=function(){return this.canDown()?new n(this.vNode.children[0],this):null},n.prototype.up=function(){return this.canUp()?this.parent:null},n.prototype.right=function(){return this.canRight()?new n(this.rightVNode(),this.parent):null},n.prototype.left=function(){return this.canLeft()?new n(this.leftVNode(),this.parent):null},n.prototype.top=function(){return this.canUp()?this.parent.top():this},n.prototype.replace=function(e){if(this.isRoot())this.vNode=e;else{var t=this.parent.vNode.children.indexOf(this.vNode);this.parent.vNode.children.splice(t,1,e),this.vNode=e}return this},n.prototype.remove=function(){if(this.isRoot());else{var e=this.parent.vNode.children.indexOf(this.vNode);this.parent.vNode.children.splice(e,1)}return this},n.prototype.insertBefore=function(e){var e=e instanceof Array?e:[e];if(this.isRoot());else{var t=this.parent.vNode.children,n=t.indexOf(this.vNode);e.reverse().forEach(function(e){t.splice(n,0,e)})}return this},n.prototype.insertAfter=function(e){var e=e instanceof Array?e:[e];if(this.isRoot());else{var t=this.parent.vNode.children,n=t.indexOf(this.vNode);t.length===n+1?t=t.concat(e):e.reverse().forEach(function(e){t.splice(n+1,0,e)})}return this},n.prototype.refresh=function(){function e(e){return e.vNode===t.vNode}var t=this,n=this.top().find(e);return this.parent=n.parent,this},n.prototype.forEach=function(e){for(var t=this;t;)e(t),t=t.next()},n.prototype.flatten=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},n.prototype.takeWhile=function(e,t){for(var t=t||"next",n=this,r=[];n&&e(n);)r.push(n),n=n[t]();return r},n.prototype.filter=function(e,t){var t=t||"next",n=[];return this.forEach(function(t){e(t)&&n.push(t)},t),n},n.prototype.find=function(e,t){for(var t=t||"next",n=this;n&&!e(n);)n=n[t]();return n}},{}]},{},[59])(59)});//# sourceMappingURL=scribe-plugin-noting.min.js.map